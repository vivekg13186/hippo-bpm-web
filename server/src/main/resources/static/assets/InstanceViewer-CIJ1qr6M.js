import{i as ye,Q as he,b as me,c as xe,d as X,_ as Y,f as Te}from"./use-quasar-DGea8EUG.js";import{Q as Se}from"./QInput-C0mA7fn5.js";import{k as qe,g as Ce,r as S,a3 as _e,c as C,w as Z,h as b,q as Ke,a4 as Ae,a5 as Ee,X as ee,I as te,J as Ie,a6 as we,a7 as le,o as De,a2 as Ne,Q as Qe,f as y,R as w,F as Be,U as r,V as pe,W as Pe,a8 as k}from"./index-CB_lE9J2.js";import{a as Ve,b as $e,Q as Fe}from"./QTable-Rvq-NHtA.js";import{a as Me,d as ze}from"./format-BdEEoX9s.js";import{Q as Le}from"./QPage-C3en1NF8.js";import{a as ae}from"./index-B9ygI19o.js";import{_ as Ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QList-CjZINhr-.js";const Oe=["none","strict","leaf","leaf-filtered"],je=qe({name:"QTree",props:{...Me,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:l=>Oe.includes(l)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:{},noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(l,{slots:q,emit:h}){const{proxy:_}=Ce(),{$q:x}=_,K=ze(l,x),c=S({}),A=S(l.ticked||[]),T=S(l.expanded||[]);let D={};_e(()=>{D={}});const B=C(()=>`q-tree q-tree--${l.dense===!0?"dense":"standard"}`+(l.noConnectors===!0?" q-tree--no-connectors":"")+(K.value===!0?" q-tree--dark":"")+(l.color!==void 0?` text-${l.color}`:"")),p=C(()=>l.selected!==void 0),N=C(()=>l.icon||x.iconSet.tree.icon),P=C(()=>l.controlColor||l.color),s=C(()=>l.textColor!==void 0?` text-${l.textColor}`:""),i=C(()=>{const t=l.selectedColor||l.color;return t?` text-${t}`:""}),Q=C(()=>l.filterMethod!==void 0?l.filterMethod:(t,a)=>{const e=a.toLowerCase();return t[l.labelKey]&&t[l.labelKey].toLowerCase().indexOf(e)!==-1}),m=C(()=>{const t={},a=(e,d)=>{const n=e.tickStrategy||(d?d.tickStrategy:l.tickStrategy),u=e[l.nodeKey],f=e[l.childrenKey]&&Array.isArray(e[l.childrenKey])&&e[l.childrenKey].length!==0,E=e.disabled!==!0&&p.value===!0&&e.selectable!==!1,g=e.disabled!==!0&&e.expandable!==!1,ge=n!=="none",F=n==="strict",J=n==="leaf-filtered",L=n==="leaf"||n==="leaf-filtered";let U=e.disabled!==!0&&e.tickable!==!1;L===!0&&U===!0&&d&&d.tickable!==!0&&(U=!1);let I=e.lazy;I===!0&&c.value[u]!==void 0&&Array.isArray(e[l.childrenKey])===!0&&(I=c.value[u]);const o={key:u,parent:d,isParent:f,lazy:I,disabled:e.disabled,link:e.disabled!==!0&&(E===!0||g===!0&&(f===!0||I===!0)),children:[],matchesFilter:l.filter?Q.value(e,l.filter):!0,selected:u===l.selected&&E===!0,selectable:E,expanded:f===!0?T.value.includes(u):!1,expandable:g,noTick:e.noTick===!0||F!==!0&&I&&I!=="loaded",tickable:U,tickStrategy:n,hasTicking:ge,strictTicking:F,leafFilteredTicking:J,leafTicking:L,ticked:F===!0?A.value.includes(u):f===!0?!1:A.value.includes(u)};if(t[u]=o,f===!0&&(o.children=e[l.childrenKey].map(v=>a(v,o)),l.filter&&(o.matchesFilter!==!0?o.matchesFilter=o.children.some(v=>v.matchesFilter):o.noTick!==!0&&o.disabled!==!0&&o.tickable===!0&&J===!0&&o.children.every(v=>v.matchesFilter!==!0||v.noTick===!0||v.tickable!==!0)===!0&&(o.tickable=!1)),o.matchesFilter===!0&&(o.noTick!==!0&&F!==!0&&o.children.every(v=>v.noTick)===!0&&(o.noTick=!0),L))){if(o.ticked=!1,o.indeterminate=o.children.some(v=>v.indeterminate===!0),o.tickable=o.tickable===!0&&o.children.some(v=>v.tickable),o.indeterminate!==!0){const v=o.children.reduce((W,ke)=>ke.ticked===!0?W+1:W,0);v===o.children.length?o.ticked=!0:v>0&&(o.indeterminate=!0)}o.indeterminate===!0&&(o.indeterminateNextState=o.children.every(v=>v.tickable!==!0||v.ticked!==!0))}return o};return l.nodes.forEach(e=>a(e,null)),t});Z(()=>l.ticked,t=>{A.value=t}),Z(()=>l.expanded,t=>{T.value=t});function V(t){const a=[].reduce,e=(d,n)=>{if(d||!n)return d;if(Array.isArray(n)===!0)return a.call(Object(n),e,d);if(n[l.nodeKey]===t)return n;if(n[l.childrenKey])return e(null,n[l.childrenKey])};return e(null,l.nodes)}function ne(){return A.value.map(t=>V(t))}function ie(){return T.value.map(t=>V(t))}function re(t){return t&&m.value[t]?m.value[t].expanded:!1}function de(){l.expanded!==void 0?h("update:expanded",[]):T.value=[]}function O(){const t=[],a=e=>{e[l.childrenKey]&&e[l.childrenKey].length!==0&&e.expandable!==!1&&e.disabled!==!0&&(t.push(e[l.nodeKey]),e[l.childrenKey].forEach(a))};l.nodes.forEach(a),l.expanded!==void 0?h("update:expanded",t):T.value=t}function M(t,a,e=V(t),d=m.value[t]){if(d.lazy&&d.lazy!=="loaded"){if(d.lazy==="loading")return;c.value[t]="loading",Array.isArray(e[l.childrenKey])!==!0&&(e[l.childrenKey]=[]),h("lazyLoad",{node:e,key:t,done:n=>{c.value[t]="loaded",e[l.childrenKey]=Array.isArray(n)===!0?n:[],Ke(()=>{m.value[t]?.isParent===!0&&j(t,!0)})},fail:()=>{delete c.value[t],e[l.childrenKey].length===0&&delete e[l.childrenKey]}})}else d.isParent===!0&&d.expandable===!0&&j(t,a)}function j(t,a){let e=T.value;const d=l.expanded!==void 0;if(d===!0&&(e=e.slice()),a){if(l.accordion&&m.value[t]){const n=[];m.value[t].parent?m.value[t].parent.children.forEach(u=>{u.key!==t&&u.expandable===!0&&n.push(u.key)}):l.nodes.forEach(u=>{const f=u[l.nodeKey];f!==t&&n.push(f)}),n.length!==0&&(e=e.filter(u=>n.includes(u)===!1))}e=e.concat([t]).filter((n,u,f)=>f.indexOf(n)===u)}else e=e.filter(n=>n!==t);d===!0?h("update:expanded",e):T.value=e}function oe(t){return t&&m.value[t]?m.value[t].ticked:!1}function $(t,a){let e=A.value;const d=l.ticked!==void 0;d===!0&&(e=e.slice()),a?e=e.concat(t).filter((n,u,f)=>f.indexOf(n)===u):e=e.filter(n=>t.includes(n)===!1),d===!0&&h("update:ticked",e)}function se(t,a,e){const d={tree:_,node:t,key:e,color:l.color,dark:K.value};return le(d,"expanded",()=>a.expanded,n=>{n!==a.expanded&&M(e,n)}),le(d,"ticked",()=>a.ticked,n=>{n!==a.ticked&&$([e],n)}),d}function H(t){return(l.filter?t.filter(a=>m.value[a[l.nodeKey]].matchesFilter):t).map(a=>ve(a))}function ue(t){if(t.icon!==void 0)return b(ee,{class:"q-tree__icon q-mr-sm",name:t.icon,color:t.iconColor});const a=t.img||t.avatar;if(a)return b("img",{class:`q-tree__${t.img?"img":"avatar"} q-mr-sm`,src:a})}function ce(){h("afterShow")}function fe(){h("afterHide")}function ve(t){const a=t[l.nodeKey],e=m.value[a],d=t.header&&q[`header-${t.header}`]||q["default-header"],n=e.isParent===!0?H(t[l.childrenKey]):[],u=n.length!==0||e.lazy&&e.lazy!=="loaded";let f=t.body&&q[`body-${t.body}`]||q["default-body"];const E=d!==void 0||f!==void 0?se(t,e,a):null;return f!==void 0&&(f=b("div",{class:"q-tree__node-body relative-position"},[b("div",{class:s.value},[f(E)])])),b("div",{key:a,class:`q-tree__node relative-position q-tree__node--${u===!0?"parent":"child"}`},[b("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(e.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(e.selected===!0?" q-tree__node--selected":"")+(e.disabled===!0?" q-tree__node--disabled":""),tabindex:e.link===!0?0:-1,ariaExpanded:n.length>0?e.expanded:null,role:"treeitem",onClick:g=>{G(t,e,g)},onKeypress(g){Ae(g)!==!0&&(g.keyCode===13?G(t,e,g,!0):g.keyCode===32&&z(t,e,g,!0))}},[b("div",{class:"q-focus-helper",tabindex:-1,ref:g=>{D[e.key]=g}}),e.lazy==="loading"?b(Ee,{class:"q-tree__spinner",color:P.value}):u===!0?b(ee,{class:"q-tree__arrow"+(e.expanded===!0?" q-tree__arrow--rotate":""),name:N.value,onClick(g){z(t,e,g)}}):null,e.hasTicking===!0&&e.noTick!==!0?b(Ve,{class:"q-tree__tickbox",modelValue:e.indeterminate===!0?null:e.ticked,color:P.value,dark:K.value,dense:!0,keepColor:!0,disable:e.tickable!==!0,onKeydown:te,"onUpdate:modelValue":g=>{be(e,g)}}):null,b("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(e.selected===!0?i.value:s.value)},[d?d(E):[ue(t),b("div",t[l.labelKey])]])]),u===!0?l.noTransition===!0?e.expanded===!0?b("div",{class:"q-tree__node-collapsible"+s.value,key:`${a}__q`},[f,b("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":""),role:"group"},n)]):null:b(ye,{duration:l.duration,onShow:ce,onHide:fe},()=>Ie(b("div",{class:"q-tree__node-collapsible"+s.value,key:`${a}__q`},[f,b("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":""),role:"group"},n)]),[[we,e.expanded]])):f])}function R(t){D[t]?.focus()}function G(t,a,e,d){d!==!0&&a.selectable!==!1&&R(a.key),p.value&&a.selectable?l.noSelectionUnset===!1?h("update:selected",a.key!==l.selected?a.key:null):a.key!==l.selected&&h("update:selected",a.key===void 0?null:a.key):z(t,a,e,d),typeof t.handler=="function"&&t.handler(t)}function z(t,a,e,d){e!==void 0&&te(e),d!==!0&&a.selectable!==!1&&R(a.key),M(a.key,!a.expanded,t,a)}function be(t,a){if(t.indeterminate===!0&&(a=t.indeterminateNextState),t.strictTicking)$([t.key],a);else if(t.leafTicking){const e=[],d=n=>{n.isParent?(a!==!0&&n.noTick!==!0&&n.tickable===!0&&e.push(n.key),n.leafTicking===!0&&n.children.forEach(d)):n.noTick!==!0&&n.tickable===!0&&(n.leafFilteredTicking!==!0||n.matchesFilter===!0)&&e.push(n.key)};d(t),$(e,a)}}return l.defaultExpandAll===!0&&O(),Object.assign(_,{getNodeByKey:V,getTickedNodes:ne,getExpandedNodes:ie,isExpanded:re,collapseAll:de,expandAll:O,setExpanded:M,isTicked:oe,setTicked:$}),()=>{const t=H(l.nodes);return b("div",{class:B.value,role:"tree"},t.length===0?l.filter?l.noResultsLabel||x.lang.tree.noResults:l.noNodesLabel||x.lang.tree.noNodes:t)}}}),He={class:"q-pb-md q-gutter-sm"},Re={class:"q-gutter-md"},Ge={class:"q-gutter-md"},Je={__name:"InstanceViewer",setup(l){const q=me(),h=S([]),_=S(null),x=S(null),K=S(""),c=S({}),A=[{align:"left",name:"taskName",label:"Task",field:"displayName",sortable:!0},{align:"left",name:"tkiid",label:"ID",field:"tkiid",sortable:!0},{align:"left",name:"state",label:"State",field:"state",sortable:!0},{align:"left",name:"lastModified",label:"Last Modified",field:"lastModificationTime",sortable:!0},{align:"left",name:" completionTime",label:"Completion Time",field:"completionTime",sortable:!0},{align:"left",name:" startTime",label:"Start Time",field:"startTime",sortable:!0},{align:"left",name:"assignedTo",label:"Assigned To",field:"assignedToDisplayName",sortable:!0},{align:"left",name:"closedBy",label:"Closed By",field:"closeByUser",sortable:!0}],T=S([]),D=()=>{var s=c.value.executionTree;s&&s.root&&(T.value=[B(s.root)])},B=s=>{var i=s.children?s.children.map(B):[];return{label:s.tokenId?`${s.name}(tkn:${s.tokenId})`:s.name,children:i}},p=()=>{x.value.start(),c.value={},N.value=[],ae({method:"POST",url:"/api/instance/"+K.value,data:_.value}).then(s=>{c.value=s.data.data,console.log(c.value),N.value=s.data.data.tasks,D()}).catch(s=>{q.notify("Error loading instance"),console.error(s)}).finally(()=>{x.value.stop()})},N=S([]),P=()=>{x.value.start(),ae({method:"GET",url:"/api/accounts"}).then(s=>{h.value=s.data}).catch(s=>{q.notify("Error loading envs"),console.error(s)}).finally(()=>{x.value.stop()})};return De(()=>{P()}),(s,i)=>(Qe(),Ne(Be,null,[y(he,{ref_key:"bar",ref:x,position:"top",size:"10px","skip-hijack":""},null,512),y(Le,{class:"q-pa-md q-gutter-md"},{default:w(()=>[r("div",He,[y(xe,null,{default:w(()=>[y(X,{label:"Home",to:"/"}),y(X,{label:"Instance Viewer"})]),_:1})]),y(Y,{title:"Application Explorer"},{default:w(()=>[r("div",Re,[y(Te,{filled:"",modelValue:_.value,"onUpdate:modelValue":i[0]||(i[0]=Q=>_.value=Q),options:h.value,label:"Enviroment","option-label":"title"},null,8,["modelValue","options"]),y(Se,{filled:"",label:"Instance ID",modelValue:K.value,"onUpdate:modelValue":i[1]||(i[1]=Q=>K.value=Q)},null,8,["modelValue"]),y(pe,{color:"primary",unelevated:"",onClick:p},{default:w(()=>[...i[2]||(i[2]=[Pe("Get Instance",-1)])]),_:1})])]),_:1}),y(Y,{title:"Instance Information"},{default:w(()=>[r("div",Ge,[y($e,{flat:"",bordered:""},{default:w(()=>[r("tbody",null,[r("tr",null,[i[3]||(i[3]=r("td",{class:"hg"},"CreationTime",-1)),r("td",null,k(c.value.creationTime),1),i[4]||(i[4]=r("td",{class:"hg"},"ExecutionState",-1)),r("td",null,k(c.value.executionState),1),i[5]||(i[5]=r("td",{class:"hg"},"State ",-1)),r("td",null,k(c.value.state),1)]),r("tr",null,[i[6]||(i[6]=r("td",{class:"hg"},"Last Modification Time",-1)),r("td",null,k(c.value.lastModificationTime),1),i[7]||(i[7]=r("td",{class:"hg"},"Name",-1)),r("td",null,k(c.value.name),1),i[8]||(i[8]=r("td",{class:"hg"},"Instance ID",-1)),r("td",null,k(c.value.piid),1)]),r("tr",null,[i[9]||(i[9]=r("td",{class:"hg"},"Process AppName",-1)),r("td",null,k(c.value.processAppName),1),i[10]||(i[10]=r("td",{class:"hg"},"Process AppAcronym",-1)),r("td",null,k(c.value.processAppAcronym),1),i[11]||(i[11]=r("td",{class:"hg"},"Process AppID",-1)),r("td",null,k(c.value.processAppID),1)]),r("tr",null,[i[12]||(i[12]=r("td",{class:"hg"},"SnapshotID",-1)),r("td",null,k(c.value.snapshotID),1),i[13]||(i[13]=r("td",{class:"hg"},"BranchID",-1)),r("td",null,k(c.value.branchID),1),i[14]||(i[14]=r("td",{class:"hg"},"Branch Name",-1)),r("td",null,k(c.value.branchName),1)]),r("tr",null,[i[15]||(i[15]=r("td",{class:"hg"},"Instance Error",-1)),r("td",null,k(c.value.instanceError),1),i[16]||(i[16]=r("td",{class:"hg"},"Predicted DueDate",-1)),r("td",null,k(c.value.predictedDueDate),1),i[17]||(i[17]=r("td",{class:"hg"},null,-1)),i[18]||(i[18]=r("td",null,null,-1))])])]),_:1}),y(Fe,{flat:"",bordered:"",columns:A,rows:N.value},null,8,["rows"])]),i[19]||(i[19]=r("h6",null,"Execution Tree",-1)),y(je,{nodes:T.value,"node-key":"label"},null,8,["nodes"])]),_:1})]),_:1})],64))}},it=Ue(Je,[["__scopeId","data-v-b5a78ae5"]]);export{it as default};
