import{Q as U,b as q,c as R,d as f,_ as g,f as j,e as N}from"./use-quasar-D2pci1K-.js";import{r as s,aj as C,o as O,a2 as w,Q as z,f as a,R as u,F as J,U as b,V as E,W as Q,Y as x}from"./index-Ce7StVvi.js";import{Q as P}from"./QPage-DIzW_2_e.js";import{C as h}from"./CodeEditor-BSGH_lYH.js";import{a as m}from"./index-B9ygI19o.js";import"./format-D_few1_3.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const $={class:"q-pb-md q-gutter-sm"},A={class:"q-gutter-md"},K={__name:"RunService",setup(F){const V=C(),n=q(),y=s([]),o=s(null),p=s(null),r=s(""),i=s(""),c=s(""),d=s(""),v=s(""),S=s(V.params.id),_=()=>{o.value.start(),m({method:"GET",url:"/api/accounts"}).then(l=>{y.value=l.data}).catch(l=>{n.notify("Error loading envs"),console.error(l)}).finally(()=>{o.value.stop()})},T=l=>{o.value.start(),m({method:"GET",url:"/api/tests/"+l}).then(e=>{const t=e.data;c.value=t.title,r.value=t.appName,i.value=t.serviceName,d.value=t.input}).catch(e=>{n.notify("Error loading test service"),console.error(e)}).finally(()=>{o.value.stop()})};O(()=>{_(),T(V.params.id)});const k=()=>{o.value.start(),m({method:"POST",url:"/api/executeService",data:{account:p.value,testService:{id:S.value,title:c.value,appName:r.value,serviceName:i.value,input:d.value}}}).then(l=>{console.log(l),v.value=JSON.stringify(l.data,null,2)}).catch(l=>{n.notify("Error running service"),console.error(l),v.value=String(l)}).finally(()=>{o.value.stop()})},B=()=>{o.value.start(),m({method:"PUT",url:"/api/tests",data:{id:S.value,title:c.value,appName:r.value,serviceName:i.value,input:d.value}}).then(l=>{n.notify("Test service saved successfully"),console.log(l)}).catch(l=>{n.notify("Error saving test service"),console.error(l)}).finally(()=>{o.value.stop()})};return(l,e)=>(z(),w(J,null,[a(U,{ref_key:"bar",ref:o,position:"top",size:"10px","skip-hijack":""},null,512),a(P,{class:"q-pa-md q-gutter-md"},{default:u(()=>[b("div",$,[a(R,null,{default:u(()=>[a(f,{label:"Home",to:"/"}),a(f,{label:"Test service",to:"/testService"}),a(f,{label:"Run service"})]),_:1})]),a(g,{title:"Run Service"},{default:u(()=>[b("div",A,[a(j,{filled:"",modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t),options:y.value,label:"Enviroment","option-label":"title"},null,8,["modelValue","options"]),a(N,{filled:"",label:"App Name",modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=t=>r.value=t)},null,8,["modelValue"]),a(N,{filled:"",label:"Service Name",modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=t=>i.value=t)},null,8,["modelValue"]),a(E,{color:"primary",unelevated:"",onClick:k},{default:u(()=>[...e[5]||(e[5]=[Q("Run",-1)])]),_:1}),a(E,{color:"primary",unelevated:"",onClick:B},{default:u(()=>[...e[6]||(e[6]=[Q("Save",-1)])]),_:1})])]),_:1}),a(g,{title:"Input JSON"},{default:u(()=>[a(x(h),{languages:[["json"]],modelValue:d.value,"onUpdate:modelValue":e[3]||(e[3]=t=>d.value=t),theme:"a11y-light","font-size":"12px","line-nums":!0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(g,{title:"Output JSON"},{default:u(()=>[a(x(h),{languages:[["json"]],modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=t=>v.value=t),theme:"a11y-light","font-size":"12px","line-nums":!0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})],64))}};export{K as default};
