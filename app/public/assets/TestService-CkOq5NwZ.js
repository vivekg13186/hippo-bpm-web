import{b as C,Q as w,c as q,d as N,_ as h,e as g}from"./use-quasar-sB_JnDOa.js";import{r as n,o as x,S as B,G as J,f as a,H as r,F as z,J as d,Q as m,M as A}from"./index-Cgg6CY0S.js";import{Q as I}from"./QForm-CnUCZ2Bt.js";import{Q as P}from"./QTd-C90NdyU5.js";import{Q as U}from"./QTable-BAhH-RTE.js";import{Q as O}from"./QPage-D0k8eBR5.js";import{a as p}from"./index-B9ygI19o.js";import{C as $}from"./CodeEditor-RpfFp743.js";import"./format-DEQCJbLs.js";import"./QList-DHH-FTCO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"q-pb-md q-gutter-sm"},F={class:"q-gutter-md"},le={__name:"TestService",setup(G){const v=n(""),f=n(""),y=n(""),i=n(`

  [ {
      "title": "Test case 1",
      "appName": "App acronym",
      "serviceName": "Service name",
      "input": "{json}"
      } ]
  `),o=n(null),s=C(),S=[{align:"left",name:"title",label:"Title",field:"title",sortable:!0},{align:"left",name:"appName",label:"App Name",field:"appName",sortable:!0},{align:"left",name:"serviceName",label:"Service Name",field:"serviceName",sortable:!0},{align:"left",name:"ID",label:"ID",field:"id"},{align:"left",name:"actions",label:"Action"}],b=n([]);x(()=>{c()});const c=()=>{o.value.start(),p({method:"GET",url:"/api/tests"}).then(l=>{b.value=l.data}).catch(l=>{s.notify("Error fetching accounts"),console.error(l)}).finally(()=>{o.value.stop()})},Q=()=>{try{var l=JSON.parse(i.value);i.value=JSON.stringify(l,null,2)}catch(t){console.error(t),s.notify("Invalid JSON");return}},T=()=>{try{var l=JSON.parse(i.value);l.length||(l=[l]),o.value.start();for(var t=0;t<l.length;t++){const e=l[t];p({method:"PUT",url:"/api/tests",data:e}).then(u=>{console.log(u)}).catch(u=>{s.notify("Error saving test service "+e.title),console.error(u)}),c(),o.value.stop()}}catch(e){console.error(e),s.notify("Invalid JSON"),o.value.stop();return}},V=()=>{o.value.start(),p({method:"PUT",url:"/api/tests",data:{title:v.value,appName:f.value,serviceName:y.value,input:"{}"}}).then(l=>{console.log(l)}).catch(l=>{s.notify("Error saving test service"),console.error(l)}).finally(()=>{o.value.stop(),c()})},k=l=>{o.value.start(),p({method:"DELETE",url:`/api/tests/${l}`}).then(()=>{}).catch(t=>{s.notify("Error deleting test service"),console.error(t)}).finally(()=>{o.value.stop(),c()})},E=l=>{console.log("edit ",l)},_=()=>{};return(l,t)=>(J(),B(z,null,[a(w,{ref_key:"bar",ref:o,position:"top",size:"10px","skip-hijack":""},null,512),a(O,{class:"q-pa-md q-gutter-md"},{default:r(()=>[d("div",D,[a(q,null,{default:r(()=>[a(N,{label:"Home",to:"/"}),a(N,{label:"Test Service"})]),_:1})]),a(h,{title:"Import Test Service"},{default:r(()=>[a(m,{color:"primary",dense:"",outline:"",icon:"code",rounded:"",size:"sm",onClick:Q}),a(A($),{languages:[["json"]],modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),theme:"a11y-light","font-size":"12px","line-nums":!0,style:{width:"100%"}},null,8,["modelValue"]),t[4]||(t[4]=d("br",null,null,-1)),d("div",F,[a(m,{type:"import",label:"import",unelevated:"",color:"primary",onClick:T})])]),_:1}),a(h,{title:"Test Service"},{default:r(()=>[a(I,{onSubmit:V,onReset:_,class:"q-gutter-md"},{default:r(()=>[a(g,{filled:"",modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=e=>v.value=e),label:"Title","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type something"]},null,8,["modelValue","rules"]),a(g,{filled:"",modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=e=>f.value=e),label:"App Name","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type something"]},null,8,["modelValue","rules"]),a(g,{filled:"",modelValue:y.value,"onUpdate:modelValue":t[3]||(t[3]=e=>y.value=e),label:"Service Name","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type something"]},null,8,["modelValue","rules"]),a(m,{type:"submit",label:"submit",unelevated:"",color:"primary"})]),_:1})]),_:1}),t[5]||(t[5]=d("div",{class:"p-ma-md"},"Â ",-1)),a(U,{columns:S,rows:b.value,flat:"",bordered:""},{"body-cell-actions":r(e=>[a(P,{props:e},{default:r(()=>[a(m,{icon:"edit",flat:"",color:"primary",to:"/runService/"+e.row.id,onClick:u=>E(e.row.id)},null,8,["to","onClick"]),a(m,{icon:"delete",flat:"",color:"primary",onClick:u=>k(e.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1})],64))}};export{le as default};
